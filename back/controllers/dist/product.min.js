"use strict";var uuid=require("uuid/v1"),Product=require("../models/Product");exports.getAllProducts=function(o,n,t){Product.find().then(function(t){var r=t.map(function(t){return t.imageUrl=o.protocol+"://"+o.get("host")+"/images/"+t.imageUrl,t});n.status(200).json(r)}).catch(function(){n.status(500).send(new Error("Database error!"))})},exports.getOneProduct=function(r,o,t){Product.findById(r.params.id).then(function(t){if(!t)return o.status(404).send(new Error("Product not found!"));t.imageUrl=r.protocol+"://"+r.get("host")+"/images/"+t.imageUrl,o.status(200).json(t)}).catch(function(){o.status(500).send(new Error("Database error!"))})},exports.orderProducts=function(e,o,t){if(!(e.body.contact&&e.body.contact.firstName&&e.body.contact.lastName&&e.body.contact.address&&e.body.contact.city&&e.body.contact.email&&e.body.products))return o.status(400).send(new Error("Bad request!"));var r=[],n=!0,a=!1,c=void 0;try{for(var u,s=function(){var n=u.value,t=new Promise(function(r,o){Product.findById(n).then(function(t){t||o("Product not found: "+n),t.imageUrl=e.protocol+"://"+e.get("host")+"/images/"+t.imageUrl,r(t)}).catch(function(){o("Database error!")})});r.push(t)},d=e.body.products[Symbol.iterator]();!(n=(u=d.next()).done);n=!0)s()}catch(t){a=!0,c=t}finally{try{n||null==d.return||d.return()}finally{if(a)throw c}}Promise.all(r).then(function(t){var r=uuid();return o.status(201).json({contact:e.body.contact,products:t,orderId:r})}).catch(function(t){return o.status(500).json(new Error(t))})};
//# sourceMappingURL=product.min.js.map

{"version":3,"sources":["cart.js"],"names":["cart","localStorage","cartCounter","totalPrice","productId","productColor","productQuantity","Contact","firstName","lastName","address","city","email","value","getProduct","id","fetch","then","httpBodyResponse","json","products","product","_id","error","alert","setFormAttributes","inputName","regexModel","min","max","title","setAttribute","updateCartCounter","i","length","key","Number","createProducts","cartKey","splitKey","split","includes","checkForm","e","document","getElementById","regNames","regAddress","regEmail","inputsToTest","regexToTest","test","errMessage","name","textContent","preventDefault","contact","orderData","postOrder","order","console","log","data","method","redirect","headers","body","JSON","stringify","response","window","location","orderId","err","hydrateDom","cartItem","createElement","cartItemImg","productImg","cartItemContent","cartItemContentDescr","cartItemContentTitle","cartItemContentColor","cartItemContentPrice","cartItemSettings","settingsQuantity","settingsQuantityText","settingsQuantityInput","deleteContainer","deleteText","appendChild","imageUrl","altTxt","price","addEventListener","target","closest","getAttribute","initialQuantity","removeItem","remove","getItem","pageContent","userForm"],"mappings":"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","sourcesContent":["/* *** VARIABLES *** */\r\nconst cart = localStorage;\r\n\r\nvar cartCounter = 0;\r\nvar totalPrice = 0;\r\n\r\nvar productId, productColor, productQuantity;\r\n\r\n\r\n\r\n\r\n/* *** CLASSES *** */\r\n\r\nclass Contact {\r\n    constructor (firstName, lastName, address, city, email) {\r\n        this.firstName = firstName.value;\r\n        this.lastName = lastName.value;\r\n        this.address = address.value;\r\n        this.city = city.value;\r\n        this.email = email.value;\r\n    }\r\n\r\n    getFirstName() {\r\n        return this.firstName;\r\n    }\r\n\r\n    getLastName() {\r\n        return this.lastName;\r\n    }\r\n\r\n    getAddress() {\r\n        return this.address;\r\n    }\r\n\r\n    getCity() {\r\n        return this.city;\r\n    }\r\n\r\n    getEmail() {\r\n        return this.email;\r\n    }\r\n}\r\n\r\n\r\n\r\n/* *** FONCTIONS *** */\r\n\r\n/* GÉNÉRAL */\r\n/* Accès aux infos produit sur serveur */\r\nasync function getProduct(id) {\r\n    return fetch(\"http://localhost:3000/api/products\")\r\n      .then(function(httpBodyResponse) {\r\n        return httpBodyResponse.json();\r\n      })\r\n      .then(function(products) {\r\n          for (product of products) { \r\n              if (product._id == id) {  \r\n                return product;}\r\n          }\r\n      })\r\n      .catch(function(error) {\r\n          alert(error);\r\n      });\r\n}\r\n\r\n/* Attributs du formulaire */\r\nasync function setFormAttributes(inputName, regexModel, min, max, title) {\r\n    inputName.setAttribute(\"pattern\", regexModel);\r\n    inputName.setAttribute(\"min-length\", min);\r\n    inputName.setAttribute(\"max-length\", max);\r\n    inputName.setAttribute(\"title\", title);\r\n}\r\n\r\n/* Màj compteur d'articles */\r\nfunction updateCartCounter(cart) {\r\n    cartCounter = 0;\r\n    for (let i = 0; i < cart.length; i++) {\r\n        let key = localStorage.key(i);\r\n        cartCounter += Number(cart[key]);\r\n    }\r\n    return cartCounter\r\n}\r\n\r\n/* FORMULAIRE */\r\n\r\n/* Création tableau commande */\r\nasync function createProducts(cart) {\r\n    let products = [];\r\n    for(let i = 0; i < cart.length; i++) {\r\n        let cartKey = localStorage.key(i);\r\n        let splitKey = cartKey.split(\" \");\r\n        productId = splitKey[0];\r\n        if (products.includes(productId)) {\r\n        }\r\n        else {\r\n            products[i] = productId;\r\n        }\r\n    }\r\n    return products;\r\n}\r\n\r\n/* Vérification et création objet contact + tableau produits */\r\nasync function checkForm(e) {\r\n\r\n    // Éléments d'input à check:\r\n    let firstName = document.getElementById(\"firstName\");\r\n    let lastName = document.getElementById(\"lastName\");\r\n    let address = document.getElementById(\"address\");\r\n    let city = document.getElementById(\"city\");\r\n    let email = document.getElementById(\"email\");\r\n\r\n    // Regexs pour check:\r\n    const regNames = /^[a-zA-Z\\s'-]+$/;\r\n    const regAddress = /^[a-zA-Z0-9\\s,'-]*$/; //problème: valide les entrées contenant uniquement des chiffres...\r\n    const regEmail = /^[A-Za-z0-9._%+-]+@([A-Za-z0-9-]+\\.)+([A-Za-z0-9]{2,4})$/;\r\n\r\n    let inputsToTest = [firstName, lastName, address, city, email];\r\n    let regexToTest = [regNames, regNames, regAddress, regNames, regEmail];\r\n\r\n    //Indicateur mauvais remplissage:        \r\n    let error = false;\r\n    \r\n    // Pour chaque élément de la liste d'input...:\r\n    for (let i = 0; i < inputsToTest.length; i++) {\r\n        // Test:\r\n        test = regexToTest[i].test(inputsToTest[i].value);\r\n        // Si test faux ne pas envoyer et message d'erreur:\r\n        if (test == false) {\r\n            errMessage = document.getElementById(inputsToTest[i].name + \"ErrorMsg\");\r\n            errMessage.textContent = \"Ce champ est vide ou n'a pas été complété correctement.\";\r\n            error = true;\r\n        }\r\n    }\r\n    \r\n    if (error == true) {\r\n        e.preventDefault();\r\n        return alert(\"Votre commande n'a pas pu être finalisée.\\nVeuillez vérifier que vous avez complété correctement le formulaire.\\n\\nEn cas de problème, n'hésitez pas à contacter notre support\");\r\n    }\r\n    else {\r\n        e.preventDefault();\r\n        contact = new Contact(firstName, lastName, address, city, email);\r\n        const products = await createProducts(cart);\r\n        orderData = {\r\n            contact,\r\n            products\r\n        };\r\n        let order = await postOrder(orderData);\r\n        console.log(order);\r\n    }\r\n\r\n}\r\n\r\n/* Envoi commande */\r\nasync function postOrder(data) {\r\n    fetch(\"http://localhost:3000/api/products/order\", {\r\n        method: \"POST\",\r\n        redirect: \"manual\",\r\n        headers: {\"Content-type\": \"application/json\"},\r\n        body: JSON.stringify(data),\r\n    })\r\n    .then(function(response) {\r\n        return response.json();\r\n    })\r\n    .then(function(json){\r\n        return window.location = \"confirmation.html?orderId=\" + json.orderId;\r\n    })\r\n    .catch(function(err) {\r\n        return console.log(\"Erreur: \", err);\r\n    })\r\n}\r\n\r\n\r\n/* *** DOM DYNAMIQUE ***  */\r\nasync function hydrateDom(product, cartCounter, totalPrice, productQuantity, cartKey) {\r\n    /* ÉLÉMENTS A GÉNÉRER ET PLACER POUR AFFICHAGE */\r\n    /* Création balises */\r\n    let cartItem = document.createElement(\"article\");\r\n    let cartItemImg = document.createElement(\"div\");\r\n    let productImg = document.createElement(\"img\");\r\n\r\n    let cartItemContent = document.createElement(\"div\");\r\n    let cartItemContentDescr = document.createElement(\"div\");\r\n    let cartItemContentTitle = document.createElement(\"h2\");\r\n    let cartItemContentColor = document.createElement(\"p\");\r\n    let cartItemContentPrice = document.createElement(\"p\");\r\n\r\n\r\n    let cartItemSettings = document.createElement(\"div\");\r\n\r\n    let settingsQuantity = document.createElement(\"div\");\r\n    let settingsQuantityText = document.createElement(\"p\");\r\n    let settingsQuantityInput = document.createElement(\"input\");\r\n\r\n    let deleteContainer = document.createElement(\"div\");\r\n    let deleteText = document.createElement(\"p\");\r\n\r\n\r\n    /* Position des balises créées */\r\n    document.getElementById(\"cart__items\").appendChild(cartItem);\r\n    cartItem.appendChild(cartItemImg);\r\n    cartItemImg.appendChild(productImg);\r\n\r\n    cartItem.appendChild(cartItemContent);\r\n    cartItemContent.appendChild(cartItemContentDescr);\r\n    cartItemContentDescr.appendChild(cartItemContentTitle);\r\n    cartItemContentDescr.appendChild(cartItemContentColor);\r\n    cartItemContentDescr.appendChild(cartItemContentPrice);\r\n\r\n    cartItemContent.appendChild(cartItemSettings);\r\n\r\n    cartItemSettings.appendChild(settingsQuantity);\r\n    settingsQuantity.appendChild(settingsQuantityText);\r\n    settingsQuantity.appendChild(settingsQuantityInput);\r\n\r\n    cartItemSettings.appendChild(deleteContainer);\r\n    deleteContainer.appendChild(deleteText);\r\n\r\n\r\n    /* Attributs et contenu des balises créées */\r\n    cartItem.setAttribute(\"class\", \"cart__item\");\r\n    cartItem.setAttribute(\"data-id\", productId);\r\n    cartItem.setAttribute(\"data-color\", productColor);\r\n\r\n    cartItemImg.setAttribute(\"class\", \"cart__item__img\")\r\n\r\n    productImg.setAttribute(\"src\", product.imageUrl);\r\n    productImg.setAttribute(\"alt\", product.altTxt);\r\n\r\n\r\n    cartItemContent.setAttribute(\"class\", \"cart__item__content\");\r\n    cartItemContentDescr.setAttribute(\"class\", \"cart__item__content__description\")\r\n    cartItemContentTitle.textContent = product.name;\r\n    cartItemContentColor.textContent = productColor;\r\n    cartItemContentPrice.textContent = Number(product.price) + \" €\";\r\n\r\n    cartItemSettings.setAttribute(\"class\", \"cart__item__content__settings\");\r\n    \r\n    settingsQuantity.setAttribute(\"class\", \"cart__item__content__settings__quantity\");\r\n    settingsQuantityText.textContent = \"Qté : \" + productQuantity;\r\n    settingsQuantityInput.setAttribute(\"type\", \"number\");\r\n    settingsQuantityInput.setAttribute(\"class\", \"itemQuantity\");\r\n    settingsQuantityInput.setAttribute(\"name\", \"itemQuantity\");\r\n    settingsQuantityInput.setAttribute(\"min\", \"1\");\r\n    settingsQuantityInput.setAttribute(\"max\", \"100\");\r\n    settingsQuantityInput.setAttribute(\"value\", productQuantity);\r\n\r\n    deleteContainer.setAttribute(\"class\", \"cart__item__content__settings__delete\");\r\n    deleteText.setAttribute(\"class\", \"deleteItem\");\r\n    deleteText.textContent = \"Supprimer\";\r\n\r\n    /* Attributs et contenus de balises existantes */\r\n    document.getElementById(\"totalQuantity\").textContent = cartCounter;\r\n    document.getElementById(\"totalPrice\").textContent = totalPrice;\r\n\r\n        /* MODIFICATIONS DU PANIER */\r\n\r\n    /* Modification quantité: */\r\n    settingsQuantityInput.addEventListener(\"change\", function(e) {\r\n        //Comptage items depuis localStorage\r\n        cartCounter = updateCartCounter(cart);\r\n        //Récupération informations objet visé\r\n        productId = e.target.closest(\".cart__item\").getAttribute(\"data-id\");\r\n        productColor = e.target.closest(\".cart__item\").getAttribute(\"data-color\");\r\n        cartKey = productId + \" \" + productColor;\r\n        //Quantité objet avant modification de l'input\r\n        let initialQuantity =  Number(cart[cartKey]);\r\n        //Màj prix et quantité\r\n        totalPrice -= initialQuantity * Number(product.price);\r\n        productQuantity = Number(e.target.value);\r\n        totalPrice += productQuantity * Number(product.price);\r\n        //Màj quantité dans le localStorage\r\n        cart[cartKey] = productQuantity;\r\n        //Màj compteur via comptage localStorage\r\n        cartCounter = updateCartCounter(cart);\r\n        //Màj affichage\r\n        document.getElementById(\"totalQuantity\").textContent = cartCounter;\r\n        document.getElementById(\"totalPrice\").textContent = totalPrice;\r\n\r\n    });\r\n    \r\n    /* Suppression d'un produit du panier: */\r\n    deleteText.addEventListener(\"click\", function(e) {\r\n        cartCounter -= Number(productQuantity);\r\n        totalPrice -= Number(productQuantity) * Number(product.price);\r\n        let cartKey = productId + \" \" + productColor;\r\n        cart.removeItem(cartKey);\r\n        document.getElementById(\"totalQuantity\").textContent = cartCounter;\r\n        document.getElementById(\"totalPrice\").textContent = totalPrice;\r\n        e.target.closest(\"article\").remove();\r\n    });\r\n}\r\n\r\n/* *** ACTIONS *** */\r\n(async function() {\r\n    /* POUR CHAQUE PRODUIT DU PANIER... */\r\n    for(let i = 0; i < cart.length; i++){\r\n        /* Infos en local storage: */\r\n        var cartKey = localStorage.key(i);\r\n        var splitKey = cartKey.split(\" \");\r\n        productId = splitKey[0];\r\n        productColor = splitKey[1];\r\n        /* Quantité (input): */\r\n        productQuantity = cart.getItem(cartKey);\r\n        /* Màj compteur d'items */\r\n        cartCounter += Number(productQuantity);\r\n\r\n        /* Infos serveur: */\r\n        var product = await getProduct(productId);\r\n        totalPrice += Number(productQuantity) * Number(product.price);\r\n\r\n        /* Génération contenu page au loading: */\r\n        var pageContent = await hydrateDom(product, cartCounter, totalPrice, productQuantity, cartKey);\r\n    }\r\n    \r\n    /* REMPLISSAGE ET VÉRFICATIONS FORMULAIRE */\r\n    /* Accès au formulaire */\r\n    var userForm = document.getElementById(\"cart__order__form\");\r\n    userForm.addEventListener(\"submit\", function (e) {\r\n        checkForm(e);\r\n    });\r\n\r\n})()\r\n\r\n        \r\n\r\n\r\n"],"file":"cart.dev.js"}
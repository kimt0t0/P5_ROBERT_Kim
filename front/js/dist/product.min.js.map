{"version":3,"sources":["product.js"],"names":["productColor","cart","productId","localStorage","getProduct","regeneratorRuntime","async","_context","prev","next","abrupt","fetch","then","httpBodyResponse","json","URL","location","href","searchParams","get","_step","_iterator","products","Symbol","iterator","_iteratorNormalCompletion","done","product","value","_id","error","alert","stop","hydrateProduct","productImgContainer","productImg","scrollColors","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","newColor","_context2","getElementById","document","createElement","appendChild","setAttribute","imageUrl","altTxt","textContent","name","price","description","undefined","colors","color","append","t0","finish","getProductId","_context3","getProductColor","select","index","_context4","selectedIndex","options","getProductQuantity","_context5","Number","addToCart","cartKey","quantity","_context7","addEventListener","productQuantity","_context9","awrap","sent","generateCartKey","includes"],"mappings":"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","file":"product.min.js","sourcesContent":["/* ***** AFFICHAGE PRODUIT ***** */\r\n\r\n/* *** VARIABLES *** */\r\nvar cart = localStorage;\r\nvar productId, productColor;\r\nvar product;\r\nvar productId;\r\n\r\n\r\n\r\n/* *** FONCTIONS *** */\r\n\r\n/* RÉCUPÉRATION PRODUIT */\r\nasync function getProduct() {\r\n    return fetch(\"http://localhost:3000/api/products\")\r\n      .then(function(httpBodyResponse) {\r\n        return httpBodyResponse.json();\r\n      })\r\n      /* récupération de l'ensemble des produits: */\r\n      .then(function(products) {\r\n        /* récupération id dans l'url: */\r\n        productId =  new URL(location.href).searchParams.get(\"id\");\r\n          /* recherche du produit correspondant: */\r\n          for (product of products) { \r\n              if (product._id == productId) {  \r\n                return product;}\r\n          }\r\n      })\r\n      .catch(function(error) {\r\n          alert(error);\r\n      });\r\n}\r\n\r\n/* GÉNÉRATION CONTENU PAGE */\r\nasync function hydrateProduct(product) {\r\n    /* Image */\r\n    let productImgContainer = document.getElementById(\"item__img\");\r\n    let productImg = document.createElement(\"img\");\r\n\r\n    productImgContainer.appendChild(productImg);\r\n\r\n    productImg.setAttribute(\"src\", product.imageUrl);\r\n    productImg.setAttribute(\"alt\", product.altTxt);\r\n\r\n    /* Titre */\r\n    document.getElementById(\"title\").textContent = product.name;\r\n    /* Prix */\r\n    document.getElementById(\"price\").textContent = product.price;\r\n    /* Description */\r\n    document.getElementById(\"description\").textContent = product.description;\r\n\r\n    /*Couleurs */\r\n    var scrollColors = document.getElementById(\"colors\");\r\n    for (color of product.colors) {\r\n        var newColor = document.createElement(\"option\");\r\n        newColor.setAttribute(\"value\", color);\r\n        newColor.textContent = color;\r\n        scrollColors.append(newColor);\r\n    }\r\n}\r\n\r\n/* GESTION PANIER */\r\nasync function getProductId(product) {\r\n    return product._id;\r\n}\r\n\r\nasync function getProductColor() {\r\n    let select = document.getElementById(\"colors\"),\r\n        index = select.selectedIndex;\r\n    return select.options[ index ].value;\r\n}\r\n\r\nasync function getProductQuantity() {\r\n    return  Number(document.getElementById(\"quantity\").value);\r\n}\r\n\r\nasync function generateCartKey (id, color) {\r\n    return id + \" \" + color;\r\n}\r\n\r\nasync function addToCart (cartKey, quantity) {\r\n    if (cart[cartKey]) {\r\n        cart[cartKey] += Number(quantity);\r\n    } \r\n    else {\r\n        cart[cartKey] = Number(quantity);\r\n    }\r\n}\r\n\r\n/* *** ACTIONS *** */\r\n/* AFFICHAGE */\r\n(async function() {\r\n    product = await getProduct();\r\n    var display = await hydrateProduct(product);\r\n})()\r\n\r\n\r\n/* PANIER */\r\ndocument.getElementById(\"addToCart\").addEventListener(\"click\", async function(e) {\r\n    /* récupérer l'id du produit et stocker dans var _id*/\r\n    let productId = await getProductId(product);\r\n\r\n    /* récupérer la couleur et stocker dans var color */\r\n    let productColor = await getProductColor();\r\n\r\n    /* récupérer la quantité et stocker dans var quantity */\r\n    let productQuantity = await getProductQuantity()\r\n\r\n    /* création des clés */\r\n    cartKey = await generateCartKey(productId, productColor);\r\n    \r\n    /* ajout au panier */\r\n    if (product.colors.includes(productColor) && productQuantity > 0) {\r\n        addToCart(cartKey, productQuantity);\r\n    } \r\n    else {\r\n        alert(\"Toutes nos excuses, le kanap n'a pas pu être ajouté au panier! \\nVous avez probablement oublié de préciser une couleur ou une quantité :-)\\n\\nN'hésitez pas à contacter notre équipe en cas de problème.\")\r\n    }\r\n          \r\n});\r\n\r\n"]}
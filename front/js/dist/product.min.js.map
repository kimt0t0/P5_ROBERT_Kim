{"version":3,"sources":["product.js"],"names":["getProduct","regeneratorRuntime","async","_context","prev","next","abrupt","fetch","then","httpBodyResponse","json","products","productId","href","searchParams","get","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","done","product","value","err","error","alert","stop","hydrateProduct","productImgContainer","productImg","scrollColors","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","newColor","_context3","document","getElementById","createElement","appendChild","setAttribute","imageUrl","altTxt","textContent","name","price","description","colors","color","append","t0","finish","cart","localStorage","getProductId","_id","getProductColor","select","selectedIndex","index","getProductQuantity","cartKey","id","addToCart","quantity","console","log","addEventListener","productColor","productQuantity","_context4"],"mappings":"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","file":"product.min.js","sourcesContent":["/* *** GÉNÉRAL *** */\r\n\r\n/* Récupération données produit */\r\nasync function getProduct() {\r\n    return fetch(\"http://localhost:3000/api/products\")\r\n      .then(function(httpBodyResponse) {\r\n        return httpBodyResponse.json();\r\n      })\r\n      /* récupération de l'ensemble des produits: */\r\n      .then(function(products) {\r\n        /* récupération id dans l'url: */\r\n        var productId =  new URL(location.href).searchParams.get(\"id\");\r\n          /* recherche du produit correspondant: */\r\n          for (product of products) { \r\n              if (product._id == productId) {  \r\n                return product;}\r\n          }\r\n      })\r\n      .catch(function(error) {\r\n          alert(error);\r\n      });\r\n}\r\n\r\n/* *** AFFICHAGE PARTIE PRODUIT *** */\r\n/* Déclencheur */\r\n(async function() {\r\n    var product = await getProduct();\r\n    hydrateProduct(product);\r\n})()\r\n\r\n/* Récupération contenu */\r\nasync function hydrateProduct(product) {\r\n    /* Affichage image */\r\n    var productImgContainer = document.getElementById(\"item__img\");\r\n    var productImg = document.createElement(\"img\");\r\n    productImgContainer.appendChild(productImg);\r\n    productImg.setAttribute(\"src\", product.imageUrl);\r\n    productImg.setAttribute(\"alt\", product.altTxt);\r\n\r\n    /* Affichage titre */\r\n    document.getElementById(\"title\").textContent = product.name;\r\n    /* Affichage prix */\r\n    document.getElementById(\"price\").textContent = product.price;\r\n    /* Affichage description */\r\n    document.getElementById(\"description\").textContent = product.description;\r\n\r\n    /*Menu couleurs */\r\n    var scrollColors = document.getElementById(\"colors\");\r\n    for (color of product.colors) {\r\n        var newColor = document.createElement(\"option\");\r\n        newColor.setAttribute(\"value\", color);\r\n        newColor.textContent = color;\r\n        scrollColors.append(newColor);\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n/* *** GESTION PANIER *** */\r\n\r\n/* Variables */\r\nvar cart = localStorage;\r\n\r\n/* FONCTIONS */\r\nfunction getProductId(product) {\r\n    return product._id;\r\n}\r\n\r\nfunction getProductColor() {\r\n    var select = document.getElementById(\"colors\"),\r\n        index = select.selectedIndex;\r\n    var productColor = select.options[ index ].value;\r\n    return productColor;\r\n}\r\n\r\nfunction getProductQuantity() {\r\n    var productQuantity = document.getElementById(\"quantity\").value;\r\n    return productQuantity;\r\n}\r\n\r\nfunction cartKey (id, color) {\r\n    return id + \" \" + color;\r\n}\r\n\r\nfunction addToCart (cartKey, quantity) {\r\n    if (cart[cartKey]) {\r\n        cart[cartKey] += quantity;\r\n        console.log(cart);\r\n    } \r\n    else {\r\n        cart[cartKey] = quantity;\r\n        console.log(cart);\r\n    }}\r\n\r\n/* Vérif: function checkCart (cart) {\r\n    console.log(cart);\r\n} */\r\n\r\n/* ACTIONS */\r\n/* Déclenchement action */\r\ndocument.getElementById(\"addToCart\").addEventListener(\"click\", async function(e) {\r\n    /* récupérer l'id du produit et stocker dans var _id*/\r\n    let productId = getProductId(product);\r\n\r\n    /* récupérer la couleur et stocker dans var color */\r\n    let productColor = getProductColor();\r\n\r\n    /* récupérer la quantité et stocker dans var quantity */\r\n    let productQuantity = getProductQuantity()\r\n\r\n    /* création des clés */\r\n    cartKey = cartKey(productId, productColor);\r\n    \r\n    /* ajout au panier */\r\n    addToCart(cartKey, productQuantity);\r\n\r\n    /* Vérif: checkCart(); */\r\n    \r\n});\r\n\r\n"]}
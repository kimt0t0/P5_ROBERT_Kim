{"version":3,"sources":["product.js"],"names":["productColor","cart","productId","localStorage","getProduct","regeneratorRuntime","async","_context","prev","next","URL","location","href","searchParams","get","abrupt","fetch","then","httpBodyResponse","json","product","error","alert","stop","hydrateProduct","productImgContainer","productImg","scrollColors","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","newColor","_context2","document","getElementById","createElement","appendChild","setAttribute","imageUrl","altTxt","textContent","name","price","description","undefined","color","append","t0","finish","_id","getProductColor","select","index","_context4","selectedIndex","options","value","getProductQuantity","_context5","Number","addToCart","cartKey","quantity","_context7","_context8","awrap","sent","addEventListener","productQuantity","_context9","getProductId","generateCartKey","colors","includes"],"mappings":"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","file":"product.min.js","sourcesContent":["/* ***** AFFICHAGE PRODUIT ***** */\r\n\r\n/* *** VARIABLES *** */\r\nvar cart = localStorage;\r\nvar productId, productColor;\r\nvar product;\r\nvar productId;\r\n\r\n\r\n\r\n/* *** FONCTIONS *** */\r\n\r\n/* RÉCUPÉRATION PRODUIT */\r\nasync function getProduct() {\r\n    productId =  new URL(location.href).searchParams.get(\"id\");\r\n    return fetch(\"http://localhost:3000/api/products/\" + productId)\r\n      .then(function(httpBodyResponse) {\r\n        return httpBodyResponse.json();\r\n      })\r\n      /* récupération de l'ensemble des produits: */\r\n      .then(function(product) {\r\n        return product;\r\n      })\r\n      .catch(function(error) {\r\n          alert(error);\r\n      });\r\n}\r\n\r\n/* GÉNÉRATION CONTENU PAGE */\r\nasync function hydrateProduct(product) {\r\n    /* Image */\r\n    let productImgContainer = document.getElementById(\"item__img\");\r\n    let productImg = document.createElement(\"img\");\r\n\r\n    productImgContainer.appendChild(productImg);\r\n\r\n    productImg.setAttribute(\"src\", product.imageUrl);\r\n    productImg.setAttribute(\"alt\", product.altTxt);\r\n\r\n    /* Titre */\r\n    document.getElementById(\"title\").textContent = product.name;\r\n    /* Prix */\r\n    document.getElementById(\"price\").textContent = product.price;\r\n    /* Description */\r\n    document.getElementById(\"description\").textContent = product.description;\r\n\r\n    /*Couleurs */\r\n    var scrollColors = document.getElementById(\"colors\");\r\n    for (color of product.colors) {\r\n        var newColor = document.createElement(\"option\");\r\n        newColor.setAttribute(\"value\", color);\r\n        newColor.textContent = color;\r\n        scrollColors.append(newColor);\r\n    }\r\n}\r\n\r\n/* GESTION PANIER */\r\nasync function getProductId(product) {\r\n    return product._id;\r\n}\r\n\r\nasync function getProductColor() {\r\n    let select = document.getElementById(\"colors\"),\r\n        index = select.selectedIndex;\r\n    return select.options[ index ].value;\r\n}\r\n\r\nasync function getProductQuantity() {\r\n    return  Number(document.getElementById(\"quantity\").value);\r\n}\r\n\r\nasync function generateCartKey (id, color) {\r\n    return id + \" \" + color;\r\n}\r\n\r\nasync function addToCart (cartKey, quantity) {\r\n    if (cart[cartKey]) {\r\n        cart[cartKey] += Number(quantity);\r\n    } \r\n    else {\r\n        cart[cartKey] = Number(quantity);\r\n    }\r\n}\r\n\r\n/* *** ACTIONS *** */\r\n/* AFFICHAGE */\r\n(async function() {\r\n    product = await getProduct();\r\n    var display = await hydrateProduct(product);\r\n})()\r\n\r\n\r\n/* PANIER */\r\ndocument.getElementById(\"addToCart\").addEventListener(\"click\", async function(e) {\r\n    /* récupérer l'id du produit et stocker dans var _id*/\r\n    let productId = await getProductId(product);\r\n\r\n    /* récupérer la couleur et stocker dans var color */\r\n    let productColor = await getProductColor();\r\n\r\n    /* récupérer la quantité et stocker dans var quantity */\r\n    let productQuantity = await getProductQuantity()\r\n\r\n    /* création des clés */\r\n    cartKey = await generateCartKey(productId, productColor);\r\n    \r\n    /* ajout au panier */\r\n    if (product.colors.includes(productColor) && productQuantity > 0) {\r\n        addToCart(cartKey, productQuantity);\r\n    } \r\n    else {\r\n        alert(\"Toutes nos excuses, le kanap n'a pas pu être ajouté au panier! \\nVous avez probablement oublié de préciser une couleur ou une quantité :-)\\n\\nN'hésitez pas à contacter notre équipe en cas de problème.\")\r\n    }\r\n          \r\n});\r\n\r\n"]}
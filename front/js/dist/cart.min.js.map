{"version":3,"sources":["cart.js"],"names":["cartCounter","productColor","productQuantity","productImgUrl","totalPrice","deleteText","cart","localStorage","getProduct","id","regeneratorRuntime","async","_context","prev","next","abrupt","fetch","then","httpBodyResponse","json","products","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","done","product","value","_id","err","error","alert","stop","setFormAttributes","inputName","regexModel","min","max","title","_context2","setAttribute","hydrateDom","cartItem","cartItemImg","productImg","cartItemContent","cartItemContentDescr","cartItemContentTitle","cartItemContentColor","cartItemContentPrice","cartItemSettings","settingsQuantity","settingsQuantityText","deleteContainer","firstName","lastName","address","city","_context3","document","createElement","settingsQuantityInput","productId","imageUrl","altTxt","textContent","name","price","appendChild","e","Number","getElementById","addEventListener","i","length","splitKey"],"mappings":"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","file":"cart.min.js","sourcesContent":["/* *** VARIABLES *** */\r\nvar cart = localStorage;\r\nvar cartCounter = 0;\r\nvar totalPrice = 0;\r\nvar productId, productColor, productQuantity, productImgUrl;\r\nvar settingsQuantityInput, deleteText;\r\n\r\n\r\n/* *** FONCTIONS *** */\r\n\r\n/* GÉNÉRAL */\r\n/* Accès aux infos produit sur serveur */\r\nasync function getProduct(id) {\r\n    return fetch(\"http://localhost:3000/api/products\")\r\n      .then(function(httpBodyResponse) {\r\n        return httpBodyResponse.json();\r\n      })\r\n      .then(function(products) {\r\n          for (product of products) { \r\n              if (product._id == id) {  \r\n                return product;}\r\n          }\r\n      })\r\n      .catch(function(error) {\r\n          alert(error);\r\n      });\r\n}\r\n\r\n/* Attributs du formulaire */\r\nasync function setFormAttributes(inputName, regexModel, min, max, title) {\r\n    inputName.setAttribute(\"pattern\", regexModel);\r\n    inputName.setAttribute(\"min-length\", min);\r\n    inputName.setAttribute(\"max-length\", max);\r\n    inputName.setAttribute(\"title\", title);\r\n}\r\n\r\n\r\n/* DOM DYNAMIQUE */\r\nasync function hydrateDom(product, cartCounter, totalPrice, productQuantity) {\r\n    /* Création balises */\r\n    let cartItem = document.createElement(\"article\");\r\n    let cartItemImg = document.createElement(\"div\");\r\n    let productImg = document.createElement(\"img\");\r\n\r\n    let cartItemContent = document.createElement(\"div\");\r\n    let cartItemContentDescr = document.createElement(\"div\");\r\n    let cartItemContentTitle = document.createElement(\"h2\");\r\n    let cartItemContentColor = document.createElement(\"p\");\r\n    let cartItemContentPrice = document.createElement(\"p\");\r\n\r\n\r\n    let cartItemSettings = document.createElement(\"div\");\r\n\r\n    let settingsQuantity = document.createElement(\"div\");\r\n    let settingsQuantityText = document.createElement(\"p\");\r\n    settingsQuantityInput = document.createElement(\"input\");\r\n\r\n    let deleteContainer = document.createElement(\"div\");\r\n    deleteText = document.createElement(\"p\");\r\n\r\n    /* Attributs et contenu des balises créées */\r\n    cartItem.setAttribute(\"class\", \"cart__item\");\r\n    cartItem.setAttribute(\"data-id\", productId);\r\n    cartItem.setAttribute(\"data-color\", productColor);\r\n\r\n    cartItemImg.setAttribute(\"class\", \"cart__item__img\")\r\n\r\n    productImg.setAttribute(\"src\", product.imageUrl);\r\n    productImg.setAttribute(\"alt\", product.altTxt);\r\n\r\n\r\n    cartItemContent.setAttribute(\"class\", \"cart__item__content\");\r\n    cartItemContentDescr.setAttribute(\"class\", \"cart__item__content__description\")\r\n    cartItemContentTitle.textContent = product.name;\r\n    cartItemContentColor.textContent = productColor;\r\n    cartItemContentPrice.textContent = product.price + \" €\";\r\n\r\n    cartItemSettings.setAttribute(\"class\", \"cart__item__content__settings\");\r\n    \r\n    settingsQuantity.setAttribute(\"class\", \"cart__item__content__settings__quantity\");\r\n    settingsQuantityText.textContent = \"Qté : \" + productQuantity;\r\n    settingsQuantityInput.setAttribute(\"type\", \"number\");\r\n    settingsQuantityInput.setAttribute(\"class\", \"itemQuantity\");\r\n    settingsQuantityInput.setAttribute(\"name\", \"itemQuantity\");\r\n    settingsQuantityInput.setAttribute(\"min\", \"1\");\r\n    settingsQuantityInput.setAttribute(\"max\", \"100\");\r\n    settingsQuantityInput.setAttribute(\"value\", productQuantity);\r\n\r\n    deleteContainer.setAttribute(\"class\", \"cart__item__content__settings__delete\");\r\n    deleteText.setAttribute(\"class\", \"deleteItem\");\r\n    deleteText.textContent = \"Supprimer\";\r\n\r\n\r\n    /* Position des balises créées */\r\n    document.getElementById(\"cart__items\").appendChild(cartItem);\r\n    cartItem.appendChild(cartItemImg);\r\n    cartItemImg.appendChild(productImg);\r\n\r\n    document.getElementById(\"cart__items\").appendChild(cartItemContent);\r\n    cartItemContent.appendChild(cartItemContentDescr);\r\n    cartItemContentDescr.appendChild(cartItemContentTitle);\r\n    cartItemContentDescr.appendChild(cartItemContentColor);\r\n    cartItemContentDescr.appendChild(cartItemContentPrice);\r\n\r\n\r\n    document.getElementById(\"cart__items\").appendChild(cartItemSettings);\r\n\r\n    cartItemSettings.appendChild(settingsQuantity);\r\n    settingsQuantity.appendChild(settingsQuantityText);\r\n    settingsQuantity.appendChild(settingsQuantityInput);\r\n\r\n    cartItemSettings.appendChild(deleteContainer);\r\n    deleteContainer.appendChild(deleteText);\r\n\r\n    /* Attributs et contenus de balises existantes */\r\n    document.getElementById(\"totalQuantity\").textContent = cartCounter;\r\n    document.getElementById(\"totalPrice\").textContent = totalPrice;\r\n\r\n        /* MODIFICATIONS DU PANIER */\r\n\r\n    /* /* Modification quantité: */\r\n    settingsQuantityInput.addEventListener(\"change\", function(e) {\r\n        /* (suppression de la quantité originale du produit dans compteur panier et prix total: ) */\r\n        cartCounter -= Number(productQuantity);\r\n        totalPrice -= Number(productQuantity) * Number(product.price);\r\n        /* (màj nouvelle quantité du produit: ) */\r\n        productQuantity = e.target.value;\r\n        settingsQuantityText.textContent = \"Qté : \" + productQuantity;\r\n        /* (màj compteur panier et prix total: ) */\r\n        cartCounter += Number(productQuantity);\r\n        totalPrice += Number(productQuantity) * Number(product.price);\r\n        document.getElementById(\"totalQuantity\").textContent = cartCounter;\r\n        document.getElementById(\"totalPrice\").textContent = totalPrice;\r\n        /* (màj local storage: ) */\r\n        cart[cartKey] = productQuantity;\r\n    });\r\n    \r\n    /* Suppression d'un produit du panier: */\r\n    deleteText.addEventListener(\"click\", function(e) {\r\n        cartCounter -= Number(productQuantity);\r\n        totalPrice -= Number(productQuantity) * Number(product.price);\r\n        let cartKey = productId + \" \" + productColor;\r\n        cart.removeItem(cartKey);\r\n        console.log(document.getElementById(productId));\r\n    });\r\n\r\n    /* MODIFICATIONS DU FORMULAIRE */\r\n    let firstName = document.getElementById('firstName');\r\n    let lastName = document.getElementById('lastName');\r\n    let address = document.getElementById('address');\r\n    let city = document.getElementById('city');\r\n\r\n    setFormAttributes(firstName, \"[-a-zA-Z]\", 2, 35, \"Entrez uniquement des lettres et '-'.\");\r\n    setFormAttributes(lastName, \"[-a-zA-Z]\", 2, 35, \"Entrez uniquement des lettres et '-'.\");\r\n    setFormAttributes(address, \"[0-9]{1, 4}[-a-zA-Z]\", 5, 35, \"Entrez une adresse.\\nExemple: 14, rue des Sufragettes\");\r\n    setFormAttributes(city, \"[- a-zA-Z]\", 2, 50, \"Entrez uniquement des lettres, '-' et ' '\");\r\n}\r\n\r\n/* *** ACTIONS *** */\r\n(async function() {\r\n    /* POUR CHAQUE PRODUIT DU PANIER... */\r\n    for(let i = 0; i < cart.length; i++){\r\n        /* Infos en local storage: */\r\n        var cartKey = localStorage.key(i);\r\n        var splitKey = cartKey.split(\" \");\r\n        productId = splitKey[0];\r\n        productColor = splitKey[1];\r\n        /* Quantité (inpupt): */\r\n        productQuantity = cart.getItem(cartKey);\r\n        /* Màj compteur d'items */\r\n        cartCounter += Number(productQuantity);\r\n\r\n        /* Infos serveur: */\r\n        var product = await getProduct(productId);\r\n        totalPrice += Number(productQuantity) * Number(product.price);\r\n\r\n        /* Génération contenu page au loading: */\r\n        var pageContent = await hydrateDom(product, cartCounter, totalPrice, productQuantity);\r\n    }\r\n\r\n})()\r\n\r\n        \r\n"]}
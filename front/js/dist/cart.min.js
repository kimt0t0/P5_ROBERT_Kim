"use strict";var productId,productColor,productQuantity,productImgUrl,settingsQuantityInput,deleteText,cart=localStorage,cartCounter=0,totalPrice=0;function getProduct(c){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch("http://localhost:3000/api/products").then(function(t){return t.json()}).then(function(t){var e=!0,n=!1,r=void 0;try{for(var a,u=t[Symbol.iterator]();!(e=(a=u.next()).done);e=!0)if(product=a.value,product._id==c)return product}catch(t){n=!0,r=t}finally{try{e||null==u.return||u.return()}finally{if(n)throw r}}}).catch(function(t){alert(t)}));case 1:case"end":return t.stop()}})}function setFormAttributes(e,n,r,a,u){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:e.setAttribute("pattern",n),e.setAttribute("min-length",r),e.setAttribute("max-length",a),e.setAttribute("title",u);case 4:case"end":return t.stop()}})}function hydrateDom(n,r,a,u,e){var c,i,o,d,s,l,m,p,g,y,_,b,h;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:c=document.createElement("article"),i=document.createElement("div"),o=document.createElement("img"),d=document.createElement("div"),s=document.createElement("div"),l=document.createElement("h2"),m=document.createElement("p"),p=document.createElement("p"),g=document.createElement("div"),y=document.createElement("div"),_=document.createElement("p"),settingsQuantityInput=document.createElement("input"),b=document.createElement("div"),deleteText=document.createElement("p"),c.setAttribute("class","cart__item"),c.setAttribute("data-id",productId),c.setAttribute("data-color",productColor),i.setAttribute("class","cart__item__img"),o.setAttribute("src",n.imageUrl),o.setAttribute("alt",n.altTxt),d.setAttribute("class","cart__item__content"),s.setAttribute("class","cart__item__content__description"),l.textContent=n.name,m.textContent=productColor,p.textContent=Number(n.price)+" €",g.setAttribute("class","cart__item__content__settings"),y.setAttribute("class","cart__item__content__settings__quantity"),_.textContent="Qté : "+u,settingsQuantityInput.setAttribute("type","number"),settingsQuantityInput.setAttribute("class","itemQuantity"),settingsQuantityInput.setAttribute("name","itemQuantity"),settingsQuantityInput.setAttribute("min","1"),settingsQuantityInput.setAttribute("max","100"),settingsQuantityInput.setAttribute("value",u),b.setAttribute("class","cart__item__content__settings__delete"),deleteText.setAttribute("class","deleteItem"),deleteText.textContent="Supprimer",document.getElementById("cart__items").appendChild(c),c.appendChild(i),i.appendChild(o),document.getElementById("cart__items").appendChild(d),d.appendChild(s),s.appendChild(l),s.appendChild(m),s.appendChild(p),document.getElementById("cart__items").appendChild(g),g.appendChild(y),y.appendChild(_),y.appendChild(settingsQuantityInput),g.appendChild(b),b.appendChild(deleteText),document.getElementById("totalQuantity").textContent=r,document.getElementById("totalPrice").textContent=a,settingsQuantityInput.addEventListener("change",function(t){r-=Number(u),a-=Number(u)*Number(n.price),u=t.target.value,_.textContent="Qté : "+u,r+=Number(u),a+=Number(u)*Number(n.price),document.getElementById("totalQuantity").textContent=r,document.getElementById("totalPrice").textContent=a,console.log("ancienne quantité: "+cart[e]),cart[e]=u,console.log("nouvelle quantité: "+cart[e])}),deleteText.addEventListener("click",function(t){r-=Number(u),a-=Number(u)*Number(n.price);var e=productId+" "+productColor;cart.removeItem(e),document.getElementById(productId).remove()}),(h=document.getElementById("cart__order__form")).addEventListener("submit",function(t){var e=h.getElementsByTagName("input"),n=e.getElementById("firstName"),r=[n,e.getElementById("lastName"),e.getElementById("address"),e.getElementById("city"),e.getElementById("email")],a=[];if(n.value!=/[\w\D- ']{2, 35}/)for(var u=0;r.length;u++){1==a[u].test(r[u])||alert("Veuillez compléter tous les champs au bon format pour finaliser votre commande :-)")}});case 57:case"end":return t.stop()}})}!function(){var e,n,r,a;regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:e=0;case 1:if(e<cart.length)return n=localStorage.key(e),r=n.split(" "),productId=r[0],productColor=r[1],productQuantity=cart.getItem(n),cartCounter+=Number(productQuantity),t.next=10,regeneratorRuntime.awrap(getProduct(productId));t.next=18;break;case 10:return a=t.sent,totalPrice+=Number(productQuantity)*Number(a.price),t.next=14,regeneratorRuntime.awrap(hydrateDom(a,cartCounter,totalPrice,productQuantity,n));case 14:t.sent;case 15:e++,t.next=1;break;case 18:console.log(userForm);case 19:case"end":return t.stop()}})}();
//# sourceMappingURL=cart.min.js.map

"use strict";var productId,productColor,productQuantity,productImgUrl,cart=localStorage,cartCounter=0,totalPrice=0;function getProduct(u){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch("http://localhost:3000/api/products").then(function(t){return t.json()}).then(function(t){var e=!0,r=!1,n=void 0;try{for(var a,c=t[Symbol.iterator]();!(e=(a=c.next()).done);e=!0)if(product=a.value,product._id==u)return product}catch(t){r=!0,n=t}finally{try{e||null==c.return||c.return()}finally{if(r)throw n}}}).catch(function(t){alert(t)}));case 1:case"end":return t.stop()}})}function setFormAttributes(e,r,n,a,c){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:e.setAttribute("pattern",r),e.setAttribute("min-length",n),e.setAttribute("max-length",a),e.setAttribute("title",c);case 4:case"end":return t.stop()}})}function hydrateDom(r,n,a,c,e){var u,o,i,s,l,d,m,p,b,g,_,h,v,y;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:(function(e,r){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.test(r));case 1:case"end":return t.stop()}})}),u=document.createElement("article"),o=document.createElement("div"),i=document.createElement("img"),s=document.createElement("div"),l=document.createElement("div"),d=document.createElement("h2"),m=document.createElement("p"),p=document.createElement("p"),b=document.createElement("div"),g=document.createElement("div"),_=document.createElement("p"),h=document.createElement("input"),v=document.createElement("div"),y=document.createElement("p"),document.getElementById("cart__items").appendChild(u),u.appendChild(o),o.appendChild(i),u.appendChild(s),s.appendChild(l),l.appendChild(d),l.appendChild(m),l.appendChild(p),s.appendChild(b),b.appendChild(g),g.appendChild(_),g.appendChild(h),b.appendChild(v),v.appendChild(y),u.setAttribute("class","cart__item"),u.setAttribute("data-id",productId),u.setAttribute("data-color",productColor),o.setAttribute("class","cart__item__img"),i.setAttribute("src",r.imageUrl),i.setAttribute("alt",r.altTxt),s.setAttribute("class","cart__item__content"),l.setAttribute("class","cart__item__content__description"),d.textContent=r.name,m.textContent=productColor,p.textContent=Number(r.price)+" €",b.setAttribute("class","cart__item__content__settings"),g.setAttribute("class","cart__item__content__settings__quantity"),_.textContent="Qté : "+c,h.setAttribute("type","number"),h.setAttribute("class","itemQuantity"),h.setAttribute("name","itemQuantity"),h.setAttribute("min","1"),h.setAttribute("max","100"),h.setAttribute("value",c),v.setAttribute("class","cart__item__content__settings__delete"),y.setAttribute("class","deleteItem"),y.textContent="Supprimer",document.getElementById("totalQuantity").textContent=n,document.getElementById("totalPrice").textContent=a,h.addEventListener("change",function(t){n-=Number(c),a-=Number(c)*Number(r.price),c=t.target.value,_.textContent="Qté : "+c,n+=Number(c),a+=Number(c)*Number(r.price),document.getElementById("totalQuantity").textContent=n,document.getElementById("totalPrice").textContent=a,console.log("ancienne quantité: "+cart[e]),cart[e]=c,console.log("nouvelle quantité: "+cart[e])}),y.addEventListener("click",function(t){n-=Number(c),a-=Number(c)*Number(r.price);var e=productId+" "+productColor;cart.removeItem(e),document.getElementById("totalQuantity").textContent=n,document.getElementById("totalPrice").textContent=a,t.target.closest("article").remove()}),document.getElementById("cart__order__form").addEventListener("submit",function(t){for(var e=document.getElementById("firstName"),r=document.getElementById("lastName"),n=document.getElementById("address"),a=document.getElementById("city"),c=document.getElementById("email"),u=/^[a-zA-Z-\s\']+$/,o=/^[0-9]{1, 4}[,\s]{0, 1}^[a-zA-Z-\s\']+$/,i=/^[\w]+$[@]+^[\w]+$[.]+^[a-z]{2, 4}/,s=0,l=new Array(e,r,n,a,c);s<l.length;s++){userInput=l[s],console.log("entrée utilisateur visée: "+userInput);var d=document.getElementById(userInput.id+"ErrorMsg");if(""==userInput.value.trim())d.textContent="Veuillez compléter ce champ.",d.style.color="red",t.preventDefault();else switch(userInput){case e||r||a:if(0==u.test(userInput)){t.preventDefault(),d.textContent="Veuillez compléter ce champ avec des lettres, espaces, tirets et apostrophes.";break}case n:if(0==o.test(userInput)){t.preventDefault(),d.textContent="Veuillez compléter ce champ avec éventuellement un numéro suivi d'une virgule et d'un espace, puis des lettres, espaces, tirets et apostrophes.";break}case c:if(0==i.test(userInput)){t.preventDefault(),d.textContent="Veuillez compléter ce champ avec une adresse email à un format valide (ex: adresse@nomdedomaine.org).";break}default:t.preventDefault(),d.textContent="Une erreur s'est produite. Veuillez réessayer plus tard.\nSi le problème persiste, n'hésitez pas à contacter notre support."}}});case 58:case"end":return t.stop()}})}!function(){var e,r,n,a;regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:e=0;case 1:if(e<cart.length)return r=localStorage.key(e),n=r.split(" "),productId=n[0],productColor=n[1],productQuantity=cart.getItem(r),cartCounter+=Number(productQuantity),t.next=10,regeneratorRuntime.awrap(getProduct(productId));t.next=18;break;case 10:return a=t.sent,totalPrice+=Number(productQuantity)*Number(a.price),t.next=14,regeneratorRuntime.awrap(hydrateDom(a,cartCounter,totalPrice,productQuantity,r));case 14:t.sent;case 15:e++,t.next=1;break;case 18:case"end":return t.stop()}})}();
//# sourceMappingURL=cart.min.js.map

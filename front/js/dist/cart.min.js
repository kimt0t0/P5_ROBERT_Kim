"use strict";var productId,productColor,productQuantity,productImgUrl,cart=localStorage,cartCounter=0,totalPrice=0;function getProduct(o){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch("http://localhost:3000/api/products").then(function(t){return t.json()}).then(function(t){var e=!0,n=!1,r=void 0;try{for(var a,c=t[Symbol.iterator]();!(e=(a=c.next()).done);e=!0)if(product=a.value,product._id==o)return product}catch(t){n=!0,r=t}finally{try{e||null==c.return||c.return()}finally{if(n)throw r}}}).catch(function(t){alert(t)}));case 1:case"end":return t.stop()}})}function setFormAttributes(e,n,r,a,c){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:e.setAttribute("pattern",n),e.setAttribute("min-length",r),e.setAttribute("max-length",a),e.setAttribute("title",c);case 4:case"end":return t.stop()}})}function hydrateDom(n,r,a,c,e){var o,u,i,d,m,l,s,p,_,g,b,y,h,v;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:o=document.createElement("article"),u=document.createElement("div"),i=document.createElement("img"),d=document.createElement("div"),m=document.createElement("div"),l=document.createElement("h2"),s=document.createElement("p"),p=document.createElement("p"),_=document.createElement("div"),g=document.createElement("div"),b=document.createElement("p"),y=document.createElement("input"),h=document.createElement("div"),v=document.createElement("p"),document.getElementById("cart__items").appendChild(o),o.appendChild(u),u.appendChild(i),o.appendChild(d),d.appendChild(m),m.appendChild(l),m.appendChild(s),m.appendChild(p),d.appendChild(_),_.appendChild(g),g.appendChild(b),g.appendChild(y),_.appendChild(h),h.appendChild(v),o.setAttribute("class","cart__item"),o.setAttribute("data-id",productId),o.setAttribute("data-color",productColor),u.setAttribute("class","cart__item__img"),i.setAttribute("src",n.imageUrl),i.setAttribute("alt",n.altTxt),d.setAttribute("class","cart__item__content"),m.setAttribute("class","cart__item__content__description"),l.textContent=n.name,s.textContent=productColor,p.textContent=Number(n.price)+" €",_.setAttribute("class","cart__item__content__settings"),g.setAttribute("class","cart__item__content__settings__quantity"),b.textContent="Qté : "+c,y.setAttribute("type","number"),y.setAttribute("class","itemQuantity"),y.setAttribute("name","itemQuantity"),y.setAttribute("min","1"),y.setAttribute("max","100"),y.setAttribute("value",c),h.setAttribute("class","cart__item__content__settings__delete"),v.setAttribute("class","deleteItem"),v.textContent="Supprimer",document.getElementById("totalQuantity").textContent=r,document.getElementById("totalPrice").textContent=a,y.addEventListener("change",function(t){r-=Number(c),a-=Number(c)*Number(n.price),c=t.target.value,b.textContent="Qté : "+c,r+=Number(c),a+=Number(c)*Number(n.price),document.getElementById("totalQuantity").textContent=r,document.getElementById("totalPrice").textContent=a,cart[e]=c}),v.addEventListener("click",function(t){r-=Number(c),a-=Number(c)*Number(n.price);var e=productId+" "+productColor;cart.removeItem(e),document.getElementById("totalQuantity").textContent=r,document.getElementById("totalPrice").textContent=a,t.target.closest("article").remove()}),document.getElementById("cart__order__form").addEventListener("submit",function(t){t.preventDefault();for(var e=/^[a-zA-Z\s'-]+$/,n=[document.getElementById("firstName"),document.getElementById("lastName"),document.getElementById("address"),document.getElementById("city"),document.getElementById("email")],r=[e,e,/^[a-zA-Z0-9\s,'-]*$/,e,/^[A-Za-z0-9._%+-]+@([A-Za-z0-9-]+\.)+([A-Za-z0-9]{2,4})$/],a=!1,c=0;n.length-1;c++)test=r[c].test(n[c].value),console.log("Test de l'input "+n[c].name+" avec la regex: "+r[c]+" -----\x3e "+test),0==test&&(errMessage=document.getElementById(n[c].name+"ErrorMsg"),errMessage.textContent="Ce champ est vide ou n'a pas été complété correctement.",a=!0);1==a?(t.preventDefault(),alert("Votre commande n'a pas pu être finalisée.\nVeuillez vérifier que vous avez complété correctement le formulaire.\n\nEn cas de problème, n'hésitez pas à contacter notre support")):(t.preventDefault(),console.log("Envoi du formulaire..."))});case 57:case"end":return t.stop()}})}!function(){var e,n,r,a;regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:e=0;case 1:if(e<cart.length)return n=localStorage.key(e),r=n.split(" "),productId=r[0],productColor=r[1],productQuantity=cart.getItem(n),cartCounter+=Number(productQuantity),t.next=10,regeneratorRuntime.awrap(getProduct(productId));t.next=18;break;case 10:return a=t.sent,totalPrice+=Number(productQuantity)*Number(a.price),t.next=14,regeneratorRuntime.awrap(hydrateDom(a,cartCounter,totalPrice,productQuantity,n));case 14:t.sent;case 15:e++,t.next=1;break;case 18:case"end":return t.stop()}})}();
//# sourceMappingURL=cart.min.js.map

{"version":3,"sources":["product.js"],"names":["cart","localStorage","productId","productColor","product","getProduct","URL","location","href","searchParams","get","fetch","then","httpBodyResponse","json","error","alert","hydrateProduct","productImgContainer","document","getElementById","productImg","createElement","appendChild","setAttribute","imageUrl","altTxt","textContent","name","price","description","scrollColors","colors","color","newColor","append","getProductId","_id","getProductColor","select","index","selectedIndex","options","value","getProductQuantity","Number","generateCartKey","id","addToCart","cartKey","quantity","display","addEventListener","e","productQuantity","includes"],"mappings":"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","sourcesContent":["/* ***** AFFICHAGE PRODUIT ***** */\r\n\r\n/* *** VARIABLES *** */\r\nvar cart = localStorage;\r\nvar productId, productColor;\r\nvar product;\r\nvar productId;\r\n\r\n\r\n\r\n/* *** FONCTIONS *** */\r\n\r\n/* RÉCUPÉRATION PRODUIT */\r\nasync function getProduct() {\r\n    productId =  new URL(location.href).searchParams.get(\"id\");\r\n    return fetch(\"http://localhost:3000/api/products/\" + productId)\r\n      .then(function(httpBodyResponse) {\r\n        return httpBodyResponse.json();\r\n      })\r\n      /* récupération de l'ensemble des produits: */\r\n      .then(function(product) {\r\n        return product;\r\n      })\r\n      .catch(function(error) {\r\n          alert(error);\r\n      });\r\n}\r\n\r\n/* GÉNÉRATION CONTENU PAGE */\r\nasync function hydrateProduct(product) {\r\n    /* Image */\r\n    let productImgContainer = document.getElementById(\"item__img\");\r\n    let productImg = document.createElement(\"img\");\r\n\r\n    productImgContainer.appendChild(productImg);\r\n\r\n    productImg.setAttribute(\"src\", product.imageUrl);\r\n    productImg.setAttribute(\"alt\", product.altTxt);\r\n\r\n    /* Titre */\r\n    document.getElementById(\"title\").textContent = product.name;\r\n    /* Prix */\r\n    document.getElementById(\"price\").textContent = product.price;\r\n    /* Description */\r\n    document.getElementById(\"description\").textContent = product.description;\r\n\r\n    /*Couleurs */\r\n    var scrollColors = document.getElementById(\"colors\");\r\n    for (color of product.colors) {\r\n        var newColor = document.createElement(\"option\");\r\n        newColor.setAttribute(\"value\", color);\r\n        newColor.textContent = color;\r\n        scrollColors.append(newColor);\r\n    }\r\n}\r\n\r\n/* GESTION PANIER */\r\nasync function getProductId(product) {\r\n    return product._id;\r\n}\r\n\r\nasync function getProductColor() {\r\n    let select = document.getElementById(\"colors\"),\r\n        index = select.selectedIndex;\r\n    return select.options[ index ].value;\r\n}\r\n\r\nasync function getProductQuantity() {\r\n    return  Number(document.getElementById(\"quantity\").value);\r\n}\r\n\r\nasync function generateCartKey (id, color) {\r\n    return id + \" \" + color;\r\n}\r\n\r\nasync function addToCart (cartKey, quantity) {\r\n    if (cart[cartKey]) {\r\n        cart[cartKey] += Number(quantity);\r\n    } \r\n    else {\r\n        cart[cartKey] = Number(quantity);\r\n    }\r\n}\r\n\r\n/* *** ACTIONS *** */\r\n/* AFFICHAGE */\r\n(async function() {\r\n    product = await getProduct();\r\n    var display = await hydrateProduct(product);\r\n})()\r\n\r\n\r\n/* PANIER */\r\ndocument.getElementById(\"addToCart\").addEventListener(\"click\", async function(e) {\r\n    /* récupérer l'id du produit et stocker dans var _id*/\r\n    let productId = await getProductId(product);\r\n\r\n    /* récupérer la couleur et stocker dans var color */\r\n    let productColor = await getProductColor();\r\n\r\n    /* récupérer la quantité et stocker dans var quantity */\r\n    let productQuantity = await getProductQuantity()\r\n\r\n    /* création des clés */\r\n    cartKey = await generateCartKey(productId, productColor);\r\n    \r\n    /* ajout au panier */\r\n    if (product.colors.includes(productColor) && productQuantity > 0) {\r\n        addToCart(cartKey, productQuantity);\r\n    } \r\n    else {\r\n        alert(\"Toutes nos excuses, le kanap n'a pas pu être ajouté au panier! \\nVous avez probablement oublié de préciser une couleur ou une quantité :-)\\n\\nN'hésitez pas à contacter notre équipe en cas de problème.\")\r\n    }\r\n          \r\n});\r\n\r\n"],"file":"product.dev.js"}
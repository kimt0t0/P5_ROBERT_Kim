{"version":3,"sources":["product.js"],"names":["getProduct","fetch","then","httpBodyResponse","json","products","productId","URL","location","href","searchParams","get","product","_id","error","alert","hydrateProduct","productImgContainer","document","getElementById","productImg","createElement","appendChild","setAttribute","imageUrl","altTxt","textContent","name","price","description","scrollColors","colors","color","newColor","append","cart","localStorage","getProductId","getProductColor","select","index","selectedIndex","productColor","options","value","getProductQuantity","productQuantity","cartKey","id","addToCart","quantity","console","log","addEventListener","e"],"mappings":"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","sourcesContent":["/* *** GÉNÉRAL *** */\r\n\r\n/* Récupération données produit */\r\nasync function getProduct() {\r\n    return fetch(\"http://localhost:3000/api/products\")\r\n      .then(function(httpBodyResponse) {\r\n        return httpBodyResponse.json();\r\n      })\r\n      /* récupération de l'ensemble des produits: */\r\n      .then(function(products) {\r\n        /* récupération id dans l'url: */\r\n        var productId =  new URL(location.href).searchParams.get(\"id\");\r\n          /* recherche du produit correspondant: */\r\n          for (product of products) { \r\n              if (product._id == productId) {  \r\n                return product;}\r\n          }\r\n      })\r\n      .catch(function(error) {\r\n          alert(error);\r\n      });\r\n}\r\n\r\n/* *** AFFICHAGE PARTIE PRODUIT *** */\r\n/* Déclencheur */\r\n(async function() {\r\n    var product = await getProduct();\r\n    hydrateProduct(product);\r\n})()\r\n\r\n/* Récupération contenu */\r\nasync function hydrateProduct(product) {\r\n    /* Affichage image */\r\n    var productImgContainer = document.getElementById(\"item__img\");\r\n    var productImg = document.createElement(\"img\");\r\n    productImgContainer.appendChild(productImg);\r\n    productImg.setAttribute(\"src\", product.imageUrl);\r\n    productImg.setAttribute(\"alt\", product.altTxt);\r\n\r\n    /* Affichage titre */\r\n    document.getElementById(\"title\").textContent = product.name;\r\n    /* Affichage prix */\r\n    document.getElementById(\"price\").textContent = product.price;\r\n    /* Affichage description */\r\n    document.getElementById(\"description\").textContent = product.description;\r\n\r\n    /*Menu couleurs */\r\n    var scrollColors = document.getElementById(\"colors\");\r\n    for (color of product.colors) {\r\n        var newColor = document.createElement(\"option\");\r\n        newColor.setAttribute(\"value\", color);\r\n        newColor.textContent = color;\r\n        scrollColors.append(newColor);\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n/* *** GESTION PANIER *** */\r\n\r\n/* Variables */\r\nvar cart = localStorage;\r\n\r\n/* FONCTIONS */\r\nfunction getProductId(product) {\r\n    return product._id;\r\n}\r\n\r\nfunction getProductColor() {\r\n    var select = document.getElementById(\"colors\"),\r\n        index = select.selectedIndex;\r\n    var productColor = select.options[ index ].value;\r\n    return productColor;\r\n}\r\n\r\nfunction getProductQuantity() {\r\n    var productQuantity = document.getElementById(\"quantity\").value;\r\n    return productQuantity;\r\n}\r\n\r\nfunction cartKey (id, color) {\r\n    return id + \" \" + color;\r\n}\r\n\r\nfunction addToCart (cartKey, quantity) {\r\n    if (cart[cartKey]) {\r\n        cart[cartKey] += quantity;\r\n        console.log(cart);\r\n    } \r\n    else {\r\n        cart[cartKey] = quantity;\r\n        console.log(cart);\r\n    }}\r\n\r\n/* Vérif: function checkCart (cart) {\r\n    console.log(cart);\r\n} */\r\n\r\n/* ACTIONS */\r\n/* Déclenchement action */\r\ndocument.getElementById(\"addToCart\").addEventListener(\"click\", async function(e) {\r\n    /* récupérer l'id du produit et stocker dans var _id*/\r\n    let productId = getProductId(product);\r\n\r\n    /* récupérer la couleur et stocker dans var color */\r\n    let productColor = getProductColor();\r\n\r\n    /* récupérer la quantité et stocker dans var quantity */\r\n    let productQuantity = getProductQuantity()\r\n\r\n    /* création des clés */\r\n    cartKey = cartKey(productId, productColor);\r\n    \r\n    /* ajout au panier */\r\n    addToCart(cartKey, productQuantity);\r\n\r\n    /* Vérif: checkCart(); */\r\n    \r\n});\r\n\r\n"],"file":"product.dev.js"}